var LINE_CHART_LEGEND='<% for (var i=0; i<datasets.length; i++) {%><li><i style="background:<%=datasets[i].fillColor%>; font-size: .85em; border-width: 1px; border-style: solid; border-color:<%=datasets[i].pointColor%>;"></i><span style="font-size: .85em;"><%if (datasets[i].label) {%><%=datasets[i].label%><%}%></span></li><%}%>',BAR_CHART_LEGEND='<% for (var i=0; i<datasets.length; i++) {%><li><i style="background:<%=datasets[i].fillColor%>; font-size: .85em; border-width: 1px; border-style: solid; border-color:<%=datasets[i].strokeColor%>;"></i><span style="font-size: .85em;"><%if (datasets[i].label) {%><%=datasets[i].label%><%}%></span></li><%}%>',DOUGHNUT_CHART_LEGEND='<% for (var i=0; i<segments.length; i++) {%><li><i style="background:<%=segments[i].fillColor%>; font-size: .85em; border-width: 1px; border-style: solid; border-color:<%=segments[i].highlightColor%>;"></i><span style="font-size: .85em;"><%if (segments[i].label) {%><%=segments[i].label%><%}%></span></li><%}%>',StatsChart=function(t,e,a){"use strict";this.fillColors=["rgba(244,67,54,0.33)","rgba(76,175,80,0.33)","rgba(96,125,139,0.33)","rgba(103,58,183,0.33)","rgba(3,169,244,0.33)","rgba(255,87,34,0.33)","rgba(233,30,99,0.33)","rgba(139,195,74,0.33)","rgba(121,85,72,0.33)","rgba(63,81,181,0.33)","rgba(0,188,212,0.33)","rgba(255,193,7,0.33)","rgba(156,39,176,0.33)","rgba(205,220,57,0.33)","rgba(158,158,158,0.33)","rgba(33,150,243,0.33)","rgba(0,150,136,0.33)","rgba(255,235,59,0.33)"],this.strokeColors=["rgba(244,67,54,1)","rgba(76,175,80,1)","rgba(96,125,139,1)","rgba(103,58,183,1)","rgba(3,169,244,1)","rgba(255,87,34,1)","rgba(233,30,99,1)","rgba(139,195,74,1)","rgba(121,85,72,1)","rgba(63,81,181,1)","rgba(0,188,212,1)","rgba(255,193,7,1)","rgba(156,39,176,1)","rgba(205,220,57,1)","rgba(158,158,158,1)","rgba(33,150,243,1)","rgba(0,150,136,1)","rgba(255,235,59,1)"],this.gaIds=t,this.gaDimensions="",this.gaMetrics="",this.gaFilters="",this.gaSort="",this.currentWeekStartDate=moment(e).format("YYYY-MM-DD"),this.currentWeekStarting=moment(e).format("DD/MM/YYYY"),this.currentWeekEndDate=moment(a).format("YYYY-MM-DD"),this.chartData=[],this.labels=[]};StatsChart.prototype.queryGA=function(t){"use strict";return new Promise(function(e,a){var r=new gapi.analytics.report.Data({query:t});r.once("success",function(t){e(t)}).once("error",function(t){a(t)}).execute()})},StatsChart.prototype.sortNumericalArray=function(t){"use strict";t.sort(function(t,e){return t-e})},StatsChart.prototype.delayExecution=function(){"use strict";return new Promise(function(t){setTimeout(t,200)})},StatsChart.prototype.makeCanvas=function(t){"use strict";var e=document.getElementById(t),a=document.createElement("canvas"),r=a.getContext("2d");return e.innerHTML="",a.width=e.offsetWidth,a.height=e.offsetHeight,e.appendChild(a),r},StatsChart.prototype.createLineChart=function(t,e){"use strict";var a=this,r=new Chart(a.makeCanvas(t)).Line(a.chartData,{legendTemplate:LINE_CHART_LEGEND});document.getElementById(e).innerHTML=r.generateLegend()},StatsChart.prototype.createBarChart=function(t,e){"use strict";var a=this,r=new Chart(a.makeCanvas(t)).Bar(a.chartData,{legendTemplate:BAR_CHART_LEGEND});document.getElementById(e).innerHTML=r.generateLegend()},StatsChart.prototype.createDoughnutChart=function(t,e){"use strict";var a=this,r=new Chart(a.makeCanvas(t)).Doughnut(a.chartData,{percentageInnerCutout:33,animateScale:!0,legendTemplate:DOUGHNUT_CHART_LEGEND});document.getElementById(e).innerHTML=r.generateLegend()};var WeekToPreviousWeekChart=function(t,e,a){"use strict";StatsChart.call(this,t,e,a),this.gaLastYearDimensions="",this.currentWeekData=[],this.previousWeekData=[],this.lastYearData=[],this.lastYearStartDate=moment(a).subtract(1,"years").format("YYYY-MM-DD"),this.lastYearEndDate=moment(a).format("YYYY-MM-DD"),this.lastWeekStartDate=moment(e).subtract(7,"days").format("YYYY-MM-DD"),this.lastWeekEndDate=moment(a).subtract(7,"days").format("YYYY-MM-DD"),this.lastWeekStarting=moment(e).subtract(7,"days").format("DD/MM/YYYY")};WeekToPreviousWeekChart.prototype=Object.create(StatsChart.prototype),WeekToPreviousWeekChart.prototype.constructor=WeekToPreviousWeekChart,WeekToPreviousWeekChart.prototype.transformLastYearDataToMedians=function(t){"use strict";var r,e=this,a={day0:[],day1:[],day2:[],day3:[],day4:[],day5:[],day6:[]};for(t.rows.forEach(function(t){a["day"+t[0]].push(+t[3])}),r=1;7>=r;r++)void 0===a["day"+r%7]?e.lastYearData.push(0):(e.sortNumericalArray(a["day"+r%7]),e.lastYearData.push(a["day"+r%7][Math.round(a["day"+r%7].length/2)]))},WeekToPreviousWeekChart.prototype.retrieveGAData=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaLastYearDimensions,metrics:t.gaMetrics,"start-date":t.lastYearStartDate,"end-date":t.lastYearEndDate,sort:t.gaSort};return t.gaFilters.length>0&&(e.filters=t.gaFilters),t.queryGA(e).then(function(e){return t.transformLastYearDataToMedians(e),t.delayExecution()}).then(function(){return e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.currentWeekStartDate,"end-date":t.currentWeekEndDate},t.queryGA(e)}).then(function(e){return t.currentWeekData=e.rows.map(function(t){return+t[2]}),t.delayExecution()}).then(function(){return e["start-date"]=t.lastWeekStartDate,e["end-date"]=t.lastWeekEndDate,t.queryGA(e)}).then(function(e){return t.previousWeekData=e.rows.map(function(t){return+t[2]}),t.labels=e.rows.map(function(t){return+t[0]}),t.labels=t.labels.map(function(t){return moment(t,"YYYYMMDD").format("ddd")}),!0}).catch(function(t){console.log(t.message)})},WeekToPreviousWeekChart.prototype.setUpChartData=function(){"use strict";var t=this;t.chartData={labels:t.labels,datasets:[{label:"Week Starting "+t.lastWeekStarting,fillColor:t.fillColors[0],strokeColor:t.strokeColors[0],pointColor:t.strokeColors[0],pointStrokeColor:"#fff",data:t.previousWeekData},{label:"Week Starting "+t.currentWeekStarting,fillColor:t.fillColors[1],strokeColor:t.strokeColors[1],pointColor:t.strokeColors[1],pointStrokeColor:"#fff",data:t.currentWeekData},{label:"Median for the Last Year",fillColor:t.fillColors[2],strokeColor:t.strokeColors[2],pointColor:t.strokeColors[2],pointStrokeColor:"#fff",data:t.lastYearData}]}};var YearToPreviousYearChart=function(t,e,a){"use strict";StatsChart.call(this,t,e,a),this.currentYearData=[],this.previousYearData=[],this.currentYearStartDate=moment(a).date(1).month(0).format("YYYY-MM-DD"),this.currentYearEndDate=moment(a).format("YYYY-MM-DD"),this.previousYearStartDate=moment(a).subtract(1,"year").date(1).month(0).format("YYYY-MM-DD"),this.previousYearEndDate=moment(a).date(1).month(0).subtract(1,"day").format("YYYY-MM-DD"),this.labels=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};YearToPreviousYearChart.prototype=Object.create(StatsChart.prototype),YearToPreviousYearChart.prototype.constructor=YearToPreviousYearChart,YearToPreviousYearChart.prototype.retrieveGAData=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.currentYearStartDate,"end-date":t.currentYearEndDate};return t.queryGA(e).then(function(e){return t.currentYearData=e.rows.map(function(t){return+t[2]}),t.delayExecution()}).then(function(){return e["start-date"]=t.previousYearStartDate,e["end-date"]=t.previousYearEndDate,t.queryGA(e)}).then(function(e){return t.previousYearData=e.rows.map(function(t){return+t[2]}),!0}).then(function(){return!0}).catch(function(t){console.log(t.message)})},YearToPreviousYearChart.prototype.setUpChartData=function(){"use strict";for(var t=this,e=0,a=t.labels.length;a>e;e++)void 0===t.currentYearData[e]&&(t.currentYearData[e]=null),void 0===t.previousYearData[e]&&(t.previousYearData[e]=null);t.chartData={labels:t.labels,datasets:[{label:"Last Year",fillColor:t.fillColors[0],strokeColor:t.strokeColors[0],data:t.previousYearData},{label:"This Year",fillColor:t.fillColors[1],strokeColor:t.strokeColors[1],data:t.currentYearData}]}};var WeekDoughnutChart=function(t,e,a){"use strict";StatsChart.call(this,t,e,a),this.topFiveData=[]};WeekDoughnutChart.prototype=Object.create(StatsChart.prototype),WeekDoughnutChart.prototype.constructor=WeekDoughnutChart,WeekDoughnutChart.prototype.retrieveAndSetUpGAData=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.currentWeekStartDate,"end-date":t.currentWeekEndDate,sort:t.gaSort,"max-results":5};return""!==t.gaFilters&&(e.filters=t.gaFilters),t.queryGA(e).then(function(e){var a=0;return e.totalResults>0?(e.rows.forEach(function(t){a+=+t[1]}),e.rows.forEach(function(e,r){t.topFiveData.push(e[0]),t.chartData.push({value:+e[1],color:t.fillColors[r],highlight:t.strokeColors[r],label:e[0]+": "+e[1]+" ("+Math.round(e[1]/a*100)+"%)"})})):t.chartData.push({value:1,color:t.fillColors[0],highlight:t.strokeColors[0],label:"No data for selected period"}),!0}).catch(function(t){console.log(t.message)})};var MonthDoughnutChart=function(t,e,a){"use strict";StatsChart.call(this,t,e,a),this.lastMonthStartDate=moment(a).subtract(1,"months").format("YYYY-MM-DD"),this.lastMonthEndDate=moment(a).format("YYYY-MM-DD")};MonthDoughnutChart.prototype=Object.create(StatsChart.prototype),MonthDoughnutChart.prototype.constructor=MonthDoughnutChart,MonthDoughnutChart.prototype.retrieveAndSetUpGAData=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.lastMonthStartDate,"end-date":t.lastMonthEndDate,sort:t.gaSort,"max-results":5};return""!==t.gaFilters&&(e.filters=t.gaFilters),t.queryGA(e).then(function(e){var a=0;return e.totalResults>0?(e.rows.forEach(function(t){a+=+t[1]}),e.rows.forEach(function(e,r){t.chartData.push({value:+e[1],color:t.fillColors[r],highlight:t.strokeColors[r],label:e[0]+": "+e[1]+" ("+Math.round(e[1]/a*100)+"%)"})})):t.chartData.push({value:1,color:t.fillColors[0],highlight:t.strokeColors[0],label:"No data for selected period"}),!0}).catch(function(t){console.log(t.message)})};var ElapsedTimeDoughnutChart=function(t,e,a){"use strict";StatsChart.call(this,t,e,a),this.elapsedTimeStartDate=moment(a).subtract(2,"years").format("YYYY-MM-DD"),this.elapsedTimeEndDate=moment(a).format("YYYY-MM-DD"),this.withinDay=0,this.withinWeek=0,this.withinMonth=0,this.withinYear=0,this.moreThanYear=0};ElapsedTimeDoughnutChart.prototype=Object.create(StatsChart.prototype),ElapsedTimeDoughnutChart.prototype.constructor=MonthDoughnutChart,ElapsedTimeDoughnutChart.prototype.retrieveAndSetUpGAData=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.elapsedTimeStartDate,"end-date":t.elapsedTimeEndDate,sort:t.gaSort};return""!==t.gaFilters&&(e.filters=t.gaFilters),t.queryGA(e).then(function(e){var a=0;return e.totalResults>0?(e.rows.forEach(function(e){+e[0]<=1?t.withinDay=t.withinDay+ +e[1]:+e[0]<=7?t.withinWeek=t.withinWeek+ +e[1]:+e[0]<=31?t.withinMonth=t.withinMonth+ +e[1]:+e[0]<=365?t.withinYear=t.withinYear+ +e[1]:t.moreThanYear=t.moreThanYear+ +e[1],a+=+e[1]}),t.chartData.push({value:t.withinDay,color:t.fillColors[0],highlight:t.strokeColors[0],label:"Within a day: "+t.withinDay+" ("+Math.round(t.withinDay/a*100)+"%)"}),t.chartData.push({value:t.withinWeek,color:t.fillColors[1],highlight:t.strokeColors[1],label:"Within a week: "+t.withinWeek+" ("+Math.round(t.withinWeek/a*100)+"%)"}),t.chartData.push({value:t.withinMonth,color:t.fillColors[2],highlight:t.strokeColors[2],label:"Within a month: "+t.withinMonth+" ("+Math.round(t.withinMonth/a*100)+"%)"}),t.chartData.push({value:t.withinYear,color:t.fillColors[3],highlight:t.strokeColors[3],label:"Within a year: "+t.withinYear+" ("+Math.round(t.withinYear/a*100)+"%)"}),t.chartData.push({value:t.moreThanYear,color:t.fillColors[4],highlight:t.strokeColors[4],label:"More than a year: "+t.moreThanYear+" ("+Math.round(t.moreThanYear/a*100)+"%)"})):t.chartData.push({value:1,color:t.fillColors[0],highlight:t.strokeColors[0],label:"No data for selected period"}),!0}).catch(function(t){console.log(t.message)})};var QuarterlyChart=function(t,e,a,r,o){"use strict";StatsChart.call(this,t,e,a),this.queryPrefix="",this.pageQuery="",this.pageData={},this.monthLabels=[],this.periodDates=[],this.searchValues=[],this.gaQueryElement=r,o.length>0&&(this.searchValues=o)};QuarterlyChart.prototype=Object.create(StatsChart.prototype),QuarterlyChart.prototype.constructor=YearToPreviousYearChart,QuarterlyChart.prototype.retrieveTopFive=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":moment().subtract(2,"years").format("YYYY-MM-DD"),"end-date":moment().format("YYYY-MM-DD"),sort:"-ga:pageviews","max-results":5};return""!==t.gaFilters&&(e.filters=t.gaFilters),0===t.searchValues.length?t.queryGA(e).then(function(e){e.totalResults>0&&e.rows.forEach(function(e){t.searchValues.push(e[0])})}).catch(function(t){return console.log(t.message),!1}):t.delayExecution()},QuarterlyChart.prototype.buildQueryAndLabels=function(){"use strict";var t=this;""!==t.queryPrefix&&(t.pageQuery=t.queryPrefix),t.searchValues.forEach(function(e,a){a>0&&(t.pageQuery=t.pageQuery+","),t.pageQuery=t.pageQuery+"ga:"+t.gaQueryElement+"=="+e,t.pageData["val"+a]=[]});for(var e=3,a=0;e>=0;e--,a++)t.monthLabels.push(moment(t.endDate).subtract(3*e+3,"months").date(1).format("MMM")+"-"+moment(t.endDate).subtract(3*e+1,"months").date(1).format("MMM")),t.periodDates.push(moment(t.endDate).subtract(3*e+3,"months").date(1).format("YYYY-MM-DD")),t.periodDates.push(moment(t.endDate).subtract(3*e,"months").date(1).subtract(1,"days").format("YYYY-MM-DD"));return!0},QuarterlyChart.prototype.retrieveGAData=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,filters:t.pageQuery,"start-date":t.periodDates[0],"end-date":t.periodDates[1]};return t.queryGA(e).then(function(e){return t.processQuarterlyResults(e),t.delayExecution()}).then(function(){return e["start-date"]=t.periodDates[2],e["end-date"]=t.periodDates[3],t.queryGA(e)}).then(function(e){return t.processQuarterlyResults(e),t.delayExecution()}).then(function(){return e["start-date"]=t.periodDates[4],e["end-date"]=t.periodDates[5],t.queryGA(e)}).then(function(e){return t.processQuarterlyResults(e),t.delayExecution()}).then(function(){return e["start-date"]=t.periodDates[6],e["end-date"]=t.periodDates[7],t.queryGA(e)}).then(function(e){return t.processQuarterlyResults(e),!0}).catch(function(t){console.log(t.message)})},QuarterlyChart.prototype.processQuarterlyResults=function(t){"use strict";var e=this;if(void 0!==t){var a=[];e.searchValues.forEach(function(){a.push(!1)});var r=e.pageData.val0.length;t.totalResults>0&&t.rows.forEach(function(t){var i=e.searchValues.indexOf(t[0]);i>-1&&(a[i]=!0,e.pageData["val"+i][r]=+t[1])});var o=0;e.searchValues.forEach(function(t,i){a[i]===!1?e.pageData["val"+i].push(0):o+=e.pageData["val"+i][r]}),o>0&&e.searchValues.forEach(function(t,a){e.pageData["val"+a][r]=(e.pageData["val"+a][r]/o*100).toFixed(2)})}return!0},QuarterlyChart.prototype.setUpChartData=function(){"use strict";var t=this;t.chartData={labels:t.monthLabels,datasets:[]},t.searchValues.forEach(function(e,a){t.chartData.datasets[a]={label:e,fillColor:t.fillColors[a],strokeColor:t.strokeColors[a],pointColor:t.strokeColors[a],pointStrokeColor:"#fff",data:t.pageData["val"+a]}})};var ActivityData=function(t,e,a){"use strict";StatsChart.call(this,t,e,a),this.previousWeekStartDate=moment(e).subtract(7,"days").format("YYYY-MM-DD"),this.previousWeekEndDate=moment(a).subtract(7,"days").format("YYYY-MM-DD"),this.previousWeekStarting=moment(this.previousWeekStartDate).format("DD/MM/YYYY"),this.lastYearStartDate=moment(a).subtract(1,"years").format("YYYY-MM-DD"),this.lastYearEndDate=moment(a).format("YYYY-MM-DD"),this.applicationCategories={lassi:["LASSI-Search","LASSI-tool-bar-button"],historicalAerialPhotographs:["OHAP-Search","OHAP-tool-bar-button"],smes:["SMES-Search","SMES-tool-bar-button"],lassiSpear:["SPEAR-Search","SPEAR-tool-bar-button"],vicnames:["VICNAMES-Search","VICNAMES-tool-bar-button"],viewMyTitles:["VMT-Search","VMT-tool-bar-button"],tpi:["TPC-tool-bar-button"]},this.applicationActivities={searchCategories:["LASSI-Search","OHAP-Search","SMES-Search","SPEAR-Search","VICNAMES-Search","VMT-Search"],panAndZoomLabels:["Pan: Drag cursor or hold shift key and drag cursor to zoom","Zoom In","Zoom Out","Zoom to Full Extent","Zoom to Greater Melbourne","Zoom to Scale"],retrieveInformationLabels:["Historical Information","Identify Aerial Photograph","Identify Property","Identify Survey Labels","Identify Survey Marks","Parcel information: click on map","Identify Feature","Identify Road. Enabled when zoom scale is 1:50,000 or below.","Polygon Search. Enabled when zoom scale is 1:10,000 or below.","View Search Results"],selectMarksLabels:["Add Mark to selection"],removeMarksLabels:["Clear Selection List","Remove Mark from selection"],displayMarkSelectionListLabels:["Display Mark Selection List Window"],mapBasedSelectLabels:["Select Parcel","Unselect Parcel","Complete Selection"],mapToolsLabels:["Markup tools","Measure Area","Measure Distance","Clear Highlight","Street View: click on map"],saveLabels:["Save Geo-Referenced Image","Save Image"],printLabels:["Print Map"],downloadLabels:["Activate Document Download Tab","Draw Polygon to Export Survey Information to LandXML","Downoad GNR Data","Export property information"],administerLabels:["Add Labels","Administration","Administrator functions","Broadcast Message","Delete Labels","Edit Labels","Export property information","Mark Maintenance","Add New GNR Record"]},this.overallActivityData={Current:{},Previous:{},Year:{}},this.overallSearchBreakdownData={Current:{},Previous:{},Year:{}},this.applicationActivityData={Current:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Previous:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Year:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}}},this.applicationSearchBreakdownData={Current:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Previous:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Year:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}}}};ActivityData.prototype=Object.create(StatsChart.prototype),ActivityData.prototype.constructor=ActivityData,ActivityData.prototype.determineApplication=function(t){"use strict";var e=this;return e.applicationCategories.lassi.indexOf(t)>=0?"LASSI General":e.applicationCategories.historicalAerialPhotographs.indexOf(t)>=0?"Historical Aerial Photographs":e.applicationCategories.smes.indexOf(t)>=0?"SMES":e.applicationCategories.lassiSpear.indexOf(t)>=0?"LASSI SPEAR Including Map Based Search":e.applicationCategories.vicnames.indexOf(t)>=0?"VICNAMES":e.applicationCategories.viewMyTitles.indexOf(t)>=0?"View My Titles":e.applicationCategories.tpi.indexOf(t)>=0?"TPI Confirm on Map":void 0},ActivityData.prototype.determineActivity=function(t,e){"use strict";var a=this;return a.applicationActivities.searchCategories.indexOf(t)>=0?"Search":a.applicationActivities.panAndZoomLabels.indexOf(e)>=0?"Pan and Zoom":a.applicationActivities.retrieveInformationLabels.indexOf(e)>=0?"Inf. / Identify":a.applicationActivities.displayMarkSelectionListLabels.indexOf(e)>=0?"Display Mark Inf.":a.applicationActivities.selectMarksLabels.indexOf(e)>=0?"Select Mark(s)":a.applicationActivities.removeMarksLabels.indexOf(e)>=0?"Deselect Marks":a.applicationActivities.mapBasedSelectLabels.indexOf(e)>=0?"Parcel Selection":a.applicationActivities.mapToolsLabels.indexOf(e)>=0?"Map Tools":a.applicationActivities.saveLabels.indexOf(e)>=0?"Save Image":a.applicationActivities.printLabels.indexOf(e)>=0?"Print Map":a.applicationActivities.downloadLabels.indexOf(e)>=0?"Download Data":a.applicationActivities.administerLabels.indexOf(e)>=0?"Administer Data":void 0},ActivityData.prototype.retrieveAndParseGAData=function(){"use strict";var t=this,e={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.currentWeekStartDate,"end-date":t.currentWeekEndDate};return t.queryGA(e).then(function(e){return e.totalResults>0&&"to use this feature visit: EVENT-TRACKING.COM"!==e.rows[0][0]&&t.parseActivityData(e,"Current"),t.delayExecution()}).then(function(){var a={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.lastWeekStartDate,"end-date":t.lastWeekEndDate};return t.queryGA(a)}).then(function(e){return e.totalResults>0&&"to use this feature visit: EVENT-TRACKING.COM"!==e.rows[0][0]&&t.parseActivityData(e,"Previous"),t.delayExecution()}).then(function(){var a={ids:t.gaIds,dimensions:t.gaDimensions,metrics:t.gaMetrics,"start-date":t.lastYearStartDate,"end-date":t.lastYearEndDate};return t.queryGA(a)}).then(function(e){return e.totalResults>0&&"to use this feature visit: EVENT-TRACKING.COM"!==e.rows[0][0]&&t.parseActivityData(e,"Year"),!0}).catch(function(t){console.log(t.message)})},ActivityData.prototype.parseActivityData=function(t,e){"use strict";var a=this;t.rows.forEach(function(t){var o=a.determineApplication(t[0]),i=a.determineActivity(t[0],t[1]);if(void 0!==o&&void 0!==i&&("Current"===e&&void 0===a.overallActivityData.Current[i]&&(a.overallActivityData.Current[i]=0,a.overallActivityData.Previous[i]=0,a.overallActivityData.Year[i]=0),"Current"===e&&void 0===a.applicationActivityData.Current[o]&&(a.applicationActivityData.Current[o]={},a.applicationActivityData.Previous[o]={},a.applicationActivityData.Year[o]={}),"Current"===e&&void 0===a.applicationActivityData.Current[o][i]&&(a.applicationActivityData.Current[o][i]=0,a.applicationActivityData.Previous[o][i]=0,a.applicationActivityData.Year[o][i]=0),void 0!==a.overallActivityData[e][i]&&(a.overallActivityData[e][i]+=+t[2]),void 0!==a.applicationActivityData[e][o][i]&&(a.applicationActivityData[e][o][i]+=+t[2]),"Search"===i)){var s=t[1];s=s.replace("Property","Prop"),s=s.replace("Description","Desc"),s=s.replace("Historical","Hist"),s=s.replace("VIEW_PFI","View PFI"),s=s.replace("Melway/VicRoads","Melway/Vicrds"),"Current"===e&&void 0===a.overallSearchBreakdownData.Current[s]&&(a.overallSearchBreakdownData.Current[s]=0,a.overallSearchBreakdownData.Previous[s]=0,a.overallSearchBreakdownData.Year[s]=0),"Current"===e&&void 0===a.applicationSearchBreakdownData.Current[o]&&(a.applicationSearchBreakdownData.Current[o]={},a.applicationSearchBreakdownData.Previous[o]={},a.applicationSearchBreakdownData.Year[o]={}),"Current"===e&&void 0===a.applicationSearchBreakdownData.Current[o][s]&&(a.applicationSearchBreakdownData.Current[o][s]=0,a.applicationSearchBreakdownData.Previous[o][s]=0,a.applicationSearchBreakdownData.Year[o][s]=0),void 0!==a.overallSearchBreakdownData[e][s]&&(a.overallSearchBreakdownData[e][s]+=+t[2]),void 0!==a.applicationSearchBreakdownData[e][o][s]&&(a.applicationSearchBreakdownData[e][o][s]+=+t[2])}})},ActivityData.prototype.prepareDoughnutChartData=function(t){"use strict";var e,a=0,r=0,o=this;o.chartData=[];for(e in t)a+=t[e];if(a>0)for(e in t)o.chartData.push({value:t[e],color:o.fillColors[r],highlight:o.strokeColors[r],label:e+": "+t[e]+" ("+Math.round(t[e]/a*100)+"%)"}),r++;else o.chartData.push({value:1,color:o.fillColors[0],highlight:o.strokeColors[0],label:"No data for selected period"});return!0},ActivityData.prototype.prepareBarChartData=function(t,e,a){"use strict";var r,o=0,i=0,s=0,n=this;n.chartData={},n.chartData.labels=[],n.chartData.datasets=[];for(r in t)o+=t[r],n.chartData.labels.push(r);for(r in e)i+=e[r];for(r in a)s+=a[r];if(o>0)for(r in t)t[r]=Math.round(t[r]/o*100);if(i>0)for(r in e)e[r]=Math.round(e[r]/i*100);if(s>0)for(r in a)a[r]=Math.round(a[r]/s*100);return o>0||i>0||s>0?n.chartData.datasets.push({label:"Week Starting "+n.currentWeekStarting,fillColor:n.fillColors[0],strokeColor:n.strokeColors[0],pointColor:n.strokeColors[0],pointStrokeColor:"#fff",data:t},{label:"Week Starting "+n.previousWeekStarting,fillColor:n.fillColors[1],strokeColor:n.strokeColors[1],pointColor:n.strokeColors[1],pointStrokeColor:"#fff",data:e},{label:"The Last Year",fillColor:n.fillColors[2],strokeColor:n.strokeColors[2],pointColor:n.strokeColors[2],pointStrokeColor:"#fff",data:a}):n.chartData.datasets.push({data:1,color:n.fillColors[0],highlight:n.strokeColors[0],label:"No data for selected period"}),!0};