var LINE_CHART_LEGEND='<% for (var i=0; i<datasets.length; i++) {%><li><i style="background:<%=datasets[i].fillColor%>; border-width: 1px; border-style: solid; border-color:<%=datasets[i].pointColor%>;"></i><%if (datasets[i].label) {%><%=datasets[i].label%><%}%></li><%}%>',BAR_CHART_LEGEND='<% for (var i=0; i<datasets.length; i++) {%><li><i style="background:<%=datasets[i].fillColor%>; border-width: 1px; border-style: solid; border-color:<%=datasets[i].strokeColor%>;"></i><%if (datasets[i].label) {%><%=datasets[i].label%><%}%></li><%}%>',DOUGHNUT_CHART_LEGEND='<% for (var i=0; i<segments.length; i++) {%><li><i style="background:<%=segments[i].fillColor%>; border-width: 1px; border-style: solid; border-color:<%=segments[i].highlightColor%>;"></i><%if (segments[i].label) {%><%=segments[i].label%><%}%></li><%}%>',StatsChart=function(e,a,t){"use strict";this.fillColors=["rgba(244,67,54,0.33)","rgba(76,175,80,0.33)","rgba(96,125,139,0.33)","rgba(103,58,183,0.33)","rgba(3,169,244,0.33)","rgba(255,87,34,0.33)","rgba(233,30,99,0.33)","rgba(139,195,74,0.33)","rgba(121,85,72,0.33)","rgba(63,81,181,0.33)","rgba(0,188,212,0.33)","rgba(255,193,7,0.33)","rgba(156,39,176,0.33)","rgba(205,220,57,0.33)","rgba(158,158,158,0.33)","rgba(33,150,243,0.33)","rgba(0,150,136,0.33)","rgba(255,235,59,0.33)"],this.strokeColors=["rgba(244,67,54,1)","rgba(76,175,80,1)","rgba(96,125,139,1)","rgba(103,58,183,1)","rgba(3,169,244,1)","rgba(255,87,34,1)","rgba(233,30,99,1)","rgba(139,195,74,1)","rgba(121,85,72,1)","rgba(63,81,181,1)","rgba(0,188,212,1)","rgba(255,193,7,1)","rgba(156,39,176,1)","rgba(205,220,57,1)","rgba(158,158,158,1)","rgba(33,150,243,1)","rgba(0,150,136,1)","rgba(255,235,59,1)"],this.gaIds=e,this.gaDimensions="",this.gaMetrics="",this.gaFilters="",this.gaSort="",this.currentWeekStartDate=moment(a).format("YYYY-MM-DD"),this.currentWeekStarting=moment(a).format("DD/MM/YYYY"),this.currentWeekEndDate=moment(t).format("YYYY-MM-DD"),this.chartData=[],this.labels=[]};StatsChart.prototype.queryGA=function(e){"use strict";return new Promise(function(a,t){var r=new gapi.analytics.report.Data({query:e});r.once("success",function(e){a(e)}).once("error",function(e){t(e)}).execute()})},StatsChart.prototype.delayExecution=function(){"use strict";return new Promise(function(e){setTimeout(e,200)})},StatsChart.prototype.makeCanvas=function(e){"use strict";var a=document.getElementById(e),t=document.createElement("canvas"),r=t.getContext("2d");return a.innerHTML="",t.width=a.offsetWidth,t.height=a.offsetHeight,a.appendChild(t),r},StatsChart.prototype.createLineChart=function(e,a){"use strict";var t=this,r=new Chart(t.makeCanvas(e)).Line(t.chartData,{legendTemplate:LINE_CHART_LEGEND});document.getElementById(a).innerHTML=r.generateLegend()},StatsChart.prototype.createBarChart=function(e,a){"use strict";var t=this,r=new Chart(t.makeCanvas(e)).Bar(t.chartData,{legendTemplate:BAR_CHART_LEGEND});document.getElementById(a).innerHTML=r.generateLegend()},StatsChart.prototype.createDoughnutChart=function(e,a){"use strict";var t=this,r=new Chart(t.makeCanvas(e)).Doughnut(t.chartData,{percentageInnerCutout:33,animateScale:!0,legendTemplate:DOUGHNUT_CHART_LEGEND});document.getElementById(a).innerHTML=r.generateLegend()};var WeekToPreviousWeekChart=function(e,a,t){"use strict";StatsChart.call(this,e,a,t),this.gaLastYearDimensions="",this.currentWeekData=[],this.previousWeekData=[],this.lastYearData=[],this.lastYearStartDate=moment(t).subtract(1,"years").format("YYYY-MM-DD"),this.lastYearEndDate=moment(t).format("YYYY-MM-DD"),this.lastWeekStartDate=moment(a).subtract(7,"days").format("YYYY-MM-DD"),this.lastWeekEndDate=moment(t).subtract(7,"days").format("YYYY-MM-DD"),this.lastWeekStarting=moment(a).subtract(7,"days").format("DD/MM/YYYY")};WeekToPreviousWeekChart.prototype=Object.create(StatsChart.prototype),WeekToPreviousWeekChart.prototype.constructor=WeekToPreviousWeekChart,WeekToPreviousWeekChart.prototype.transformLastYearDataToMedians=function(e){"use strict";var r,a=this,t={day0:[],day1:[],day2:[],day3:[],day4:[],day5:[],day6:[]};for(e.rows.forEach(function(e){t["day"+e[0]].push(+e[3])}),r=1;7>=r;r++)a.lastYearData.push(void 0===t["day"+r%7]?0:t["day"+r%7][Math.round(t["day"+r%7].length/2)])},WeekToPreviousWeekChart.prototype.retrieveGAData=function(){"use strict";var e=this,a={ids:e.gaIds,dimensions:e.gaLastYearDimensions,metrics:e.gaMetrics,"start-date":e.lastYearStartDate,"end-date":e.lastYearEndDate,sort:e.gaSort};return e.gaFilters.length>0&&(a.filters=e.gaFilters),e.queryGA(a).then(function(a){return e.transformLastYearDataToMedians(a),e.delayExecution()}).then(function(){return a={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":e.currentWeekStartDate,"end-date":e.currentWeekEndDate},e.queryGA(a)}).then(function(a){return e.currentWeekData=a.rows.map(function(e){return+e[2]}),e.delayExecution()}).then(function(){return a["start-date"]=e.lastWeekStartDate,a["end-date"]=e.lastWeekEndDate,e.queryGA(a)}).then(function(a){return e.previousWeekData=a.rows.map(function(e){return+e[2]}),e.labels=a.rows.map(function(e){return+e[0]}),e.labels=e.labels.map(function(e){return moment(e,"YYYYMMDD").format("ddd")}),!0}).catch(function(e){console.log(e.message)})},WeekToPreviousWeekChart.prototype.setUpChartData=function(){"use strict";var e=this;e.chartData={labels:e.labels,datasets:[{label:"Week Starting "+e.lastWeekStarting,fillColor:e.fillColors[0],strokeColor:e.strokeColors[0],pointColor:e.strokeColors[0],pointStrokeColor:"#fff",data:e.previousWeekData},{label:"Week Starting "+e.currentWeekStarting,fillColor:e.fillColors[1],strokeColor:e.strokeColors[1],pointColor:e.strokeColors[1],pointStrokeColor:"#fff",data:e.currentWeekData},{label:"Median for the Last Year",fillColor:e.fillColors[2],strokeColor:e.strokeColors[2],pointColor:e.strokeColors[2],pointStrokeColor:"#fff",data:e.lastYearData}]}};var YearToPreviousYearChart=function(e,a,t){"use strict";StatsChart.call(this,e,a,t),this.currentYearData=[],this.previousYearData=[],this.currentYearStartDate=moment(t).date(1).month(0).format("YYYY-MM-DD"),this.currentYearEndDate=moment(t).format("YYYY-MM-DD"),this.previousYearStartDate=moment(t).subtract(1,"year").date(1).month(0).format("YYYY-MM-DD"),this.previousYearEndDate=moment(t).date(1).month(0).subtract(1,"day").format("YYYY-MM-DD"),this.labels=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};YearToPreviousYearChart.prototype=Object.create(StatsChart.prototype),YearToPreviousYearChart.prototype.constructor=YearToPreviousYearChart,YearToPreviousYearChart.prototype.retrieveGAData=function(){"use strict";var e=this,a={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":e.currentYearStartDate,"end-date":e.currentYearEndDate};return e.queryGA(a).then(function(a){return e.currentYearData=a.rows.map(function(e){return+e[2]}),e.delayExecution()}).then(function(){return a["start-date"]=e.previousYearStartDate,a["end-date"]=e.previousYearEndDate,e.queryGA(a)}).then(function(a){return e.previousYearData=a.rows.map(function(e){return+e[2]}),!0}).then(function(){return!0}).catch(function(e){console.log(e.message)})},YearToPreviousYearChart.prototype.setUpChartData=function(){"use strict";for(var e=this,a=0,t=e.labels.length;t>a;a++)void 0===e.currentYearData[a]&&(e.currentYearData[a]=null),void 0===e.previousYearData[a]&&(e.previousYearData[a]=null);e.chartData={labels:e.labels,datasets:[{label:"Last Year",fillColor:e.fillColors[0],strokeColor:e.strokeColors[0],data:e.previousYearData},{label:"This Year",fillColor:e.fillColors[1],strokeColor:e.strokeColors[1],data:e.currentYearData}]}};var WeekDoughnutChart=function(e,a,t){"use strict";StatsChart.call(this,e,a,t),this.topFiveData=[]};WeekDoughnutChart.prototype=Object.create(StatsChart.prototype),WeekDoughnutChart.prototype.constructor=WeekDoughnutChart,WeekDoughnutChart.prototype.retrieveAndSetUpGAData=function(){"use strict";var e=this,a={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":e.currentWeekStartDate,"end-date":e.currentWeekEndDate,sort:e.gaSort,"max-results":5};return""!==e.gaFilters&&(a.filters=e.gaFilters),e.queryGA(a).then(function(a){var t=0;return a.totalResults>0?(a.rows.forEach(function(e){t+=+e[1]}),a.rows.forEach(function(a,r){e.topFiveData.push(a[0]),e.chartData.push({value:+a[1],color:e.fillColors[r],highlight:e.strokeColors[r],label:a[0]+": "+a[1]+" ("+Math.round(a[1]/t*100)+"%)"})})):e.chartData.push({value:1,color:e.fillColors[0],highlight:e.strokeColors[0],label:"No data for selected period"}),!0}).catch(function(e){console.log(e.message)})};var YearDoughnutChart=function(e,a,t){"use strict";StatsChart.call(this,e,a,t),this.lastYearStartDate=moment(t).subtract(1,"years").format("YYYY-MM-DD"),this.lastYearEndDate=moment(t).format("YYYY-MM-DD")};YearDoughnutChart.prototype=Object.create(StatsChart.prototype),YearDoughnutChart.prototype.constructor=YearDoughnutChart,YearDoughnutChart.prototype.retrieveAndSetUpGAData=function(){"use strict";var e=this,a={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":e.lastYearStartDate,"end-date":e.lastYearEndDate,sort:e.gaSort,"max-results":5};return""!==e.gaFilters&&(a.filters=e.gaFilters),e.queryGA(a).then(function(a){var t=0;return a.totalResults>0?(a.rows.forEach(function(e){t+=+e[1]}),a.rows.forEach(function(a,r){e.chartData.push({value:+a[1],color:e.fillColors[r],highlight:e.strokeColors[r],label:a[0]+": "+a[1]+" ("+Math.round(a[1]/t*100)+"%)"})})):e.chartData.push({value:1,color:e.fillColors[0],highlight:e.strokeColors[0],label:"No data for selected period"}),!0}).catch(function(e){console.log(e.message)})};var QuarterlyChart=function(e,a,t,r,n){"use strict";StatsChart.call(this,e,a,t),this.queryPrefix="",this.pageQuery="",this.pageData={},this.monthLabels=[],this.periodDates=[],this.searchValues=[],this.gaQueryElement=r,n.length>0&&(this.searchValues=n)};QuarterlyChart.prototype=Object.create(StatsChart.prototype),QuarterlyChart.prototype.constructor=YearToPreviousYearChart,QuarterlyChart.prototype.retrieveTopFive=function(){"use strict";var e=this,a={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":moment().subtract(2,"years").format("YYYY-MM-DD"),"end-date":moment().format("YYYY-MM-DD"),sort:"-ga:pageviews","max-results":5};return""!==e.gaFilters&&(a.filters=e.gaFilters),0===e.searchValues.length?e.queryGA(a).then(function(a){a.totalResults>0&&a.rows.forEach(function(a){e.searchValues.push(a[0])})}).catch(function(e){return console.log(e.message),!1}):e.delayExecution()},QuarterlyChart.prototype.buildQueryAndLabels=function(){"use strict";var e=this;""!==e.queryPrefix&&(e.pageQuery=e.queryPrefix),e.searchValues.forEach(function(a,t){t>0&&(e.pageQuery=e.pageQuery+","),e.pageQuery=e.pageQuery+"ga:"+e.gaQueryElement+"=="+a,e.pageData["val"+t]=[]});for(var a=3,t=0;a>=0;a--,t++)e.monthLabels.push(moment(e.endDate).subtract(3*a+3,"months").date(1).format("MMM")+"-"+moment(e.endDate).subtract(3*a+1,"months").date(1).format("MMM")),e.periodDates.push(moment(e.endDate).subtract(3*a+3,"months").date(1).format("YYYY-MM-DD")),e.periodDates.push(moment(e.endDate).subtract(3*a,"months").date(1).subtract(1,"days").format("YYYY-MM-DD"));return!0},QuarterlyChart.prototype.retrieveGAData=function(){"use strict";var e=this,a={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,filters:e.pageQuery,"start-date":e.periodDates[0],"end-date":e.periodDates[1]};return e.queryGA(a).then(function(a){return e.processQuarterlyResults(a),e.delayExecution()}).then(function(){return a["start-date"]=e.periodDates[2],a["end-date"]=e.periodDates[3],e.queryGA(a)}).then(function(a){return e.processQuarterlyResults(a),e.delayExecution()}).then(function(){return a["start-date"]=e.periodDates[4],a["end-date"]=e.periodDates[5],e.queryGA(a)}).then(function(a){return e.processQuarterlyResults(a),e.delayExecution()}).then(function(){return a["start-date"]=e.periodDates[6],a["end-date"]=e.periodDates[7],e.queryGA(a)}).then(function(a){return e.processQuarterlyResults(a),!0}).catch(function(e){console.log(e.message)})},QuarterlyChart.prototype.processQuarterlyResults=function(e){"use strict";var a=this;if(void 0!==e){var t=[];a.searchValues.forEach(function(){t.push(!1)});var r=a.pageData.val0.length;e.totalResults>0&&e.rows.forEach(function(e){var i=a.searchValues.indexOf(e[0]);i>-1&&(t[i]=!0,a.pageData["val"+i][r]=+e[1])});var n=0;a.searchValues.forEach(function(e,i){t[i]===!1?a.pageData["val"+i].push(0):n+=a.pageData["val"+i][r]}),n>0&&a.searchValues.forEach(function(e,t){a.pageData["val"+t][r]=(a.pageData["val"+t][r]/n*100).toFixed(2)})}return!0},QuarterlyChart.prototype.setUpChartData=function(){"use strict";var e=this;e.chartData={labels:e.monthLabels,datasets:[]},e.searchValues.forEach(function(a,t){e.chartData.datasets[t]={label:a,fillColor:e.fillColors[t],strokeColor:e.strokeColors[t],pointColor:e.strokeColors[t],pointStrokeColor:"#fff",data:e.pageData["val"+t]}})};var ActivityData=function(e,a,t){"use strict";StatsChart.call(this,e,a,t),this.previousWeekStartDate=moment(a).subtract(7,"days").format("YYYY-MM-DD"),this.previousWeekEndDate=moment(t).subtract(7,"days").format("YYYY-MM-DD"),this.previousWeekStarting=moment(this.previousWeekStartDate).format("DD/MM/YYYY"),this.lastYearStartDate=moment(t).subtract(1,"years").format("YYYY-MM-DD"),this.lastYearEndDate=moment(t).format("YYYY-MM-DD"),this.applicationCategories={lassi:["LASSI-Search","LASSI-tool-bar-button"],historicalAerialPhotographs:["OHAP-Search","OHAP-tool-bar-button"],smes:["SMES-Search","SMES-tool-bar-button"],lassiSpear:["SPEAR-Search","SPEAR-tool-bar-button"],vicnames:["VICNAMES-Search","VICNAMES-tool-bar-button"],viewMyTitles:["VMT-Search","VMT-tool-bar-button"],tpi:["TPC-tool-bar-button"]},this.applicationActivities={searchCategories:["LASSI-Search","OHAP-Search","SMES-Search","SPEAR-Search","VICNAMES-Search","VMT-Search"],panAndZoomLabels:["Pan: Drag cursor or hold shift key and drag cursor to zoom","Zoom In","Zoom Out","Zoom to Full Extent","Zoom to Greater Melbourne","Zoom to Scale"],retrieveInformationLabels:["Add Mark to selection","Clear Selection List","Display Mark Selection List Window","Historical Information","Identify Aerial Photograph","Identify Property","Identify Survey Labels","Identify Survey Marks","Parcel information: click on map"],mapBasedSelectLabels:["Select Parcel","Unselect Parcel","Complete Selection"],mapToolsLabels:["Markup tools","Measure Area","Measure Distance","Clear Highlight","Street View: click on map"],saveLabels:["Save Geo-Referenced Image","Save Image"],printLabels:["Print Map"],downloadLabels:["Activate Document Download Tab","Draw Polygon to Export Survey Information to LandXML"],administerLabels:["Add Labels","Administration","Administrator functions","Broadcast Message","Delete Labels","Edit Labels","Export property information","Mark Maintenance"]},this.overallActivityData={Current:{},Previous:{},Year:{}},this.overallSearchBreakdownData={Current:{},Previous:{},Year:{}},this.applicationActivityData={Current:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Previous:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Year:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}}},this.applicationSearchBreakdownData={Current:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Previous:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}},Year:{"LASSI General":{},"Historical Aerial Photographs":{},SMES:{},"LASSI SPEAR Including Map Based Search":{},VICNAMES:{},"View My Titles":{},"TPI Confirm on Map":{}}}};ActivityData.prototype=Object.create(StatsChart.prototype),ActivityData.prototype.constructor=ActivityData,ActivityData.prototype.determineApplication=function(e){"use strict";var a=this;return a.applicationCategories.lassi.indexOf(e)>=0?"LASSI General":a.applicationCategories.historicalAerialPhotographs.indexOf(e)>=0?"Historical Aerial Photographs":a.applicationCategories.smes.indexOf(e)>=0?"SMES":a.applicationCategories.lassiSpear.indexOf(e)>=0?"LASSI SPEAR Including Map Based Search":a.applicationCategories.vicnames.indexOf(e)>=0?"VICNAMES":a.applicationCategories.viewMyTitles.indexOf(e)>=0?"View My Titles":a.applicationCategories.tpi.indexOf(e)>=0?"TPI Confirm on Map":void 0},ActivityData.prototype.determineActivity=function(e,a){"use strict";var t=this;return t.applicationActivities.searchCategories.indexOf(e)>=0?"Search":t.applicationActivities.panAndZoomLabels.indexOf(a)>=0?"Pan and Zoom":t.applicationActivities.retrieveInformationLabels.indexOf(a)>=0?"Retrieve Information":t.applicationActivities.mapBasedSelectLabels.indexOf(a)>=0?"Map Based Parcel Select":t.applicationActivities.mapToolsLabels.indexOf(a)>=0?"Map Tools":t.applicationActivities.saveLabels.indexOf(a)>=0?"Save Image":t.applicationActivities.printLabels.indexOf(a)>=0?"Print Map":t.applicationActivities.downloadLabels.indexOf(a)>=0?"Download Data":t.applicationActivities.administerLabels.indexOf(a)>=0?"Administer Data":void 0},ActivityData.prototype.retrieveAndParseGAData=function(){"use strict";var e=this,a={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":e.currentWeekStartDate,"end-date":e.currentWeekEndDate};return e.queryGA(a).then(function(a){return a.totalResults>0&&"to use this feature visit: EVENT-TRACKING.COM"!==a.rows[0][0]&&e.parseActivityData(a,"Current"),e.delayExecution()}).then(function(){var t={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":e.lastWeekStartDate,"end-date":e.lastWeekEndDate};return e.queryGA(t)}).then(function(a){return a.totalResults>0&&"to use this feature visit: EVENT-TRACKING.COM"!==a.rows[0][0]&&e.parseActivityData(a,"Previous"),e.delayExecution()}).then(function(){var t={ids:e.gaIds,dimensions:e.gaDimensions,metrics:e.gaMetrics,"start-date":e.lastYearStartDate,"end-date":e.lastYearEndDate};return e.queryGA(t)}).then(function(a){return a.totalResults>0&&"to use this feature visit: EVENT-TRACKING.COM"!==a.rows[0][0]&&e.parseActivityData(a,"Year"),!0}).catch(function(e){console.log(e.message)})},ActivityData.prototype.parseActivityData=function(e,a){"use strict";var t=this;e.rows.forEach(function(e){var n=t.determineApplication(e[0]),i=t.determineActivity(e[0],e[1]);void 0!==n&&void 0!==i&&("Current"===a&&void 0===t.overallActivityData.Current[i]&&(t.overallActivityData.Current[i]=0,t.overallActivityData.Previous[i]=0,t.overallActivityData.Year[i]=0),"Current"===a&&void 0===t.applicationActivityData.Current[n]&&(t.applicationActivityData.Current[n]={},t.applicationActivityData.Previous[n]={},t.applicationActivityData.Year[n]={}),"Current"===a&&void 0===t.applicationActivityData.Current[n][i]&&(t.applicationActivityData.Current[n][i]=0,t.applicationActivityData.Previous[n][i]=0,t.applicationActivityData.Year[n][i]=0),void 0!==t.overallActivityData[a][i]&&(t.overallActivityData[a][i]+=+e[2]),void 0!==t.applicationActivityData[a][n][i]&&(t.applicationActivityData[a][n][i]+=+e[2]),"Search"===i&&("Current"===a&&void 0===t.overallSearchBreakdownData.Current[e[1]]&&(t.overallSearchBreakdownData.Current[e[1]]=0,t.overallSearchBreakdownData.Previous[e[1]]=0,t.overallSearchBreakdownData.Year[e[1]]=0),"Current"===a&&void 0===t.applicationSearchBreakdownData.Current[n]&&(t.applicationSearchBreakdownData.Current[n]={},t.applicationSearchBreakdownData.Previous[n]={},t.applicationSearchBreakdownData.Year[n]={}),"Current"===a&&void 0===t.applicationSearchBreakdownData.Current[n][e[1]]&&(t.applicationSearchBreakdownData.Current[n][e[1]]=0,t.applicationSearchBreakdownData.Previous[n][e[1]]=0,t.applicationSearchBreakdownData.Year[n][e[1]]=0),void 0!==t.overallSearchBreakdownData[a][e[1]]&&(t.overallSearchBreakdownData[a][e[1]]+=+e[2]),void 0!==t.applicationSearchBreakdownData[a][n][e[1]]&&(t.applicationSearchBreakdownData[a][n][e[1]]+=+e[2])))})},ActivityData.prototype.prepareDoughnutChartData=function(e){"use strict";var a,t=0,r=0,n=this;n.chartData=[];for(a in e)t+=e[a];if(t>0)for(a in e)n.chartData.push({value:e[a],color:n.fillColors[r],highlight:n.strokeColors[r],label:a+": "+e[a]+" ("+Math.round(e[a]/t*100)+"%)"}),r++;else n.chartData.push({value:1,color:n.fillColors[0],highlight:n.strokeColors[0],label:"No data for selected period"});return!0},ActivityData.prototype.prepareBarChartData=function(e,a,t){"use strict";var r,n=0,i=this;i.chartData={},i.chartData.labels=[],i.chartData.datasets=[];for(r in e)n+=e[r],i.chartData.labels.push(r.replace(" ","\n"));for(r in a)n+=a[r];for(r in t)n+=t[r];if(n>0){for(r in e)e[r]=Math.round(e[r]/n*100);for(r in a)a[r]=Math.round(a[r]/n*100);for(r in t)t[r]=Math.round(t[r]/n*100);i.chartData.datasets.push({label:"Week Starting "+i.currentWeekStarting,fillColor:i.fillColors[0],strokeColor:i.strokeColors[0],pointColor:i.strokeColors[0],pointStrokeColor:"#fff",data:e},{label:"Week Starting "+i.previousWeekStarting,fillColor:i.fillColors[1],strokeColor:i.strokeColors[1],pointColor:i.strokeColors[1],pointStrokeColor:"#fff",data:a},{label:"The Last Year",fillColor:i.fillColors[2],strokeColor:i.strokeColors[2],pointColor:i.strokeColors[2],pointStrokeColor:"#fff",data:t})}else i.chartData.datasets.push({data:1,color:i.fillColors[0],highlight:i.strokeColors[0],label:"No data for selected period"});return!0};