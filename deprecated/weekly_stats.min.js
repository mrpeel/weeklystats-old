function showLoadingBar(){document.getElementById("load-bar").className="loader"}function hideLoadingBar(){document.getElementById("load-bar").className="loader-hidden"}function renderCharts(e,r,t){showLoadingBar(),renderWeekOverWeekSessions(e,r,t)}function renderWeekOverWeekSessions(e,r,t){function s(e){var r=[],t=[],a=[],n=[],i=[],s=[],c=[];e.rows.forEach(function(e,o){switch(+e[0]){case 0:c.push(+e[3]);break;case 1:r.push(+e[3]);break;case 2:t.push(+e[3]);break;case 3:a.push(+e[3]);break;case 4:n.push(+e[3]);break;case 5:i.push(+e[3]);break;case 6:s.push(+e[3])}}),r.length>0?o.push(r[Math.round(r.length/2)]):o.push(0),t.length>0?o.push(t[Math.round(t.length/2)]):o.push(0),a.length>0?o.push(a[Math.round(a.length/2)]):o.push(0),n.length>0?o.push(n[Math.round(n.length/2)]):o.push(0),i.length>0?o.push(i[Math.round(i.length/2)]):o.push(0),s.length>0?o.push(s[Math.round(s.length/2)]):o.push(0),c.length>0?o.push(c[Math.round(c.length/2)]):o.push(0)}function c(){var s={labels:i,datasets:[{label:"Week Starting "+moment(r).subtract(7,"days").format("DD/MM/YYYY"),fillColor:fillColors[0],strokeColor:strokeColors[0],pointColor:strokeColors[0],pointStrokeColor:"#fff",data:n},{label:"Week Starting "+moment(r).format("DD/MM/YYYY"),fillColor:fillColors[1],strokeColor:strokeColors[1],pointColor:strokeColors[1],pointStrokeColor:"#fff",data:a},{label:"Median for the Last Year",fillColor:fillColors[2],strokeColor:strokeColors[2],pointColor:strokeColors[2],pointStrokeColor:"#fff",data:o}]},c=new Chart(makeCanvas("weekly-session-chart-container")).Line(s,{legendTemplate:lineChartLegend});document.getElementById("weekly-session-legend-container").innerHTML=c.generateLegend(),renderYearOverYearSessions(e,r,t)}var a,n,i,o=[];query({ids:e,dimensions:"ga:dayOfWeek,ga:year,ga:nthWeek",metrics:"ga:sessions",filters:"ga:sessions>0","start-date":moment(t).subtract(1,"years").format("YYYY-MM-DD"),"end-date":t,sort:"ga:dayOfWeek,-ga:sessions"}).then(function(e){return s(e),rateLimitDelay()}).then(function(a){return query({ids:e,dimensions:"ga:date,ga:nthDay",metrics:"ga:sessions","start-date":r,"end-date":t})}).then(function(e){return a=e.rows.map(function(e){return+e[2]}),rateLimitDelay()}).then(function(a){return query({ids:e,dimensions:"ga:date,ga:nthDay",metrics:"ga:sessions","start-date":moment(r).subtract(7,"days").format("YYYY-MM-DD"),"end-date":moment(t).subtract(7,"days").format("YYYY-MM-DD")})}).then(function(e){n=e.rows.map(function(e){return+e[2]}),i=e.rows.map(function(e){return+e[0]}),i=i.map(function(e){return moment(e,"YYYYMMDD").format("ddd")}),c()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderYearOverYearSessions(e,r,t){function s(){for(var i=0,s=o.length;s>i;i++)void 0===a[i]&&(a[i]=null),void 0===n[i]&&(n[i]=null);var c={labels:o,datasets:[{label:"Last Year",fillColor:fillColors[0],strokeColor:strokeColors[0],data:n},{label:"This Year",fillColor:fillColors[1],strokeColor:strokeColors[1],data:a}]},u=new Chart(makeCanvas("monthly-session-chart-container")).Bar(c,{legendTemplate:barChartLegend});document.getElementById("monthly-session-legend-container").innerHTML=u.generateLegend(),renderWeekOverWeekSessionDuration(e,r,t)}var a,n,o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];query({ids:e,dimensions:"ga:month,ga:nthMonth",metrics:"ga:sessions","start-date":moment(t).date(1).month(0).format("YYYY-MM-DD"),"end-date":moment(t).format("YYYY-MM-DD")}).then(function(e){return a=e.rows.map(function(e){return+e[2]}),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:month,ga:nthMonth",metrics:"ga:sessions","start-date":moment(t).subtract(1,"year").date(1).month(0).format("YYYY-MM-DD"),"end-date":moment(t).date(1).month(0).subtract(1,"day").format("YYYY-MM-DD")})}).then(function(e){n=e.rows.map(function(e){return+e[2]}),s()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderWeekOverWeekSessionDuration(e,r,t){function c(e){var r=[],t=[],a=[],n=[],i=[],s=[],c=[];e.rows.forEach(function(e,o){switch(+e[0]){case 0:c.push((+e[3]/60).toFixed(2));break;case 1:r.push((+e[3]/60).toFixed(2));break;case 2:t.push((+e[3]/60).toFixed(2));break;case 3:a.push((+e[3]/60).toFixed(2));break;case 4:n.push((+e[3]/60).toFixed(2));break;case 5:i.push((+e[3]/60).toFixed(2));break;case 6:s.push((+e[3]/60).toFixed(2))}}),r.length>0?o.push(r[Math.round(r.length/2)]):o.push(0),t.length>0?o.push(t[Math.round(t.length/2)]):o.push(0),a.length>0?o.push(a[Math.round(a.length/2)]):o.push(0),n.length>0?o.push(n[Math.round(n.length/2)]):o.push(0),i.length>0?o.push(i[Math.round(i.length/2)]):o.push(0),s.length>0?o.push(s[Math.round(s.length/2)]):o.push(0),c.length>0?o.push(c[Math.round(c.length/2)]):o.push(0)}function u(){var s={labels:i,datasets:[{label:"Week Starting "+moment(r).format("DD/MM/YYYY"),fillColor:fillColors[0],strokeColor:strokeColors[0],pointColor:strokeColors[0],pointStrokeColor:"#fff",data:a},{label:"Week Starting "+moment(r).subtract(7,"days").format("DD/MM/YYYY"),fillColor:fillColors[1],strokeColor:strokeColors[1],pointColor:strokeColors[1],pointStrokeColor:"#fff",data:n},{label:"Median for the Last Year",fillColor:fillColors[2],strokeColor:strokeColors[2],pointColor:strokeColors[2],pointStrokeColor:"#fff",data:o}]},c=new Chart(makeCanvas("weekly-session-duration-chart-container")).Line(s,{legendTemplate:lineChartLegend});document.getElementById("weekly-session-duration-legend-container").innerHTML=c.generateLegend(),renderYearOverYearSessionDuration(e,r,t)}var a,n,i,o=[];query({ids:e,dimensions:"ga:dayOfWeek,ga:year,ga:nthWeek",metrics:"ga:avgSessionDuration",filters:"ga:avgSessionDuration>0","start-date":moment(t).subtract(1,"years").format("YYYY-MM-DD"),"end-date":t,sort:"ga:dayOfWeek,-ga:avgSessionDuration"}).then(function(e){return c(e),rateLimitDelay()}).then(function(a){return query({ids:e,dimensions:"ga:date,ga:nthDay",metrics:"ga:avgSessionDuration","start-date":r,"end-date":t})}).then(function(e){return a=e.rows.map(function(e){return(+e[2]/60).toFixed(2)}),rateLimitDelay()}).then(function(a){return query({ids:e,dimensions:"ga:date,ga:nthDay",metrics:"ga:avgSessionDuration","start-date":moment(r).subtract(7,"days").format("YYYY-MM-DD"),"end-date":moment(t).subtract(7,"days").format("YYYY-MM-DD")})}).then(function(e){n=e.rows.map(function(e){return(+e[2]/60).toFixed(2)}),i=e.rows.map(function(e){return+e[0]}),i=i.map(function(e){return moment(e,"YYYYMMDD").format("ddd")}),u()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderYearOverYearSessionDuration(e,r,t){function s(){for(var i=0,s=o.length;s>i;i++)void 0===a[i]&&(a[i]=null),void 0===n[i]&&(n[i]=null);var c={labels:o,datasets:[{label:"Last Year",fillColor:fillColors[0],strokeColor:strokeColors[0],data:n},{label:"This Year",fillColor:fillColors[1],strokeColor:strokeColors[1],data:a}]},u=new Chart(makeCanvas("monthly-session-duration-chart-container")).Bar(c,{legendTemplate:barChartLegend});document.getElementById("monthly-session-duration-legend-container").innerHTML=u.generateLegend(),renderWeekContentUsage(e,r,t)}var a,n,o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];query({ids:e,dimensions:"ga:month,ga:nthMonth",metrics:"ga:avgSessionDuration","start-date":moment(t).date(1).month(0).format("YYYY-MM-DD"),"end-date":moment(t).format("YYYY-MM-DD")}).then(function(e){return a=e.rows.map(function(e){return(+e[2]/60).toFixed(2)}),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:month,ga:nthMonth",metrics:"ga:avgSessionDuration","start-date":moment(t).subtract(1,"year").date(1).month(0).format("YYYY-MM-DD"),"end-date":moment(t).date(1).month(0).subtract(1,"day").format("YYYY-MM-DD")})}).then(function(e){n=e.rows.map(function(e){return(+e[2]/60).toFixed(2)}),s()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderWeekContentUsage(e,r,t){function i(r){var t=0;return r.totalResults>0?(r.rows.forEach(function(e,r){t+=+e[1]}),r.rows.forEach(function(e,r){n.push({value:+e[1],color:fillColors[r],highlight:strokeColors[r],label:e[0]+": "+e[1]+" ("+Math.round(e[1]/t*100)+"%)"}),a.push(e[0])}),!0):(n.push({value:1,color:fillColors[0],highlight:strokeColors[0],label:"No data for selected period"}),allTimeTopPageNames.length>0?(a=allTimeTopPageNames.slice(),!0):rateLimitDelay().then(function(r){return query({ids:e,dimensions:"ga:pageTitle",metrics:"ga:pageviews",filters:"ga:pageTitle!=Redirect;ga:pageviews>10","start-date":moment().subtract(2,"years").format("YYYY-MM-DD"),"end-date":moment().format("YYYY-MM-DD"),sort:"-ga:pageviews","max-results":5})}).then(function(e){return e.totalResults>0&&e.rows.forEach(function(e,r){allTimeTopPageNames.push(e[0]),a.push(e[0])}),!0})["catch"](function(e){return console.error(e.error.message),!1}))}function s(){var o=new Chart(makeCanvas("weekly-content-chart-container")).Doughnut(n,{percentageInnerCutout:33,animateScale:!0,legendTemplate:dougnutChartLegend});document.getElementById("weekly-content-legend-container").innerHTML=o.generateLegend(),renderQuarterlyContentUsage(e,r,t,a)}var a=[],n=[];query({ids:e,dimensions:"ga:pageTitle",metrics:"ga:pageviews",filters:"ga:pageTitle!=Redirect;ga:pageviews>10","start-date":r,"end-date":t,sort:"-ga:pageviews","max-results":5}).then(function(e){return i(e)}).then(function(e){s()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderQuarterlyContentUsage(e,r,t,a){function h(){var n={labels:i,datasets:[]};a.forEach(function(e,r,t){n.datasets[r]={label:e,fillColor:fillColors[r],strokeColor:strokeColors[r],pointColor:strokeColors[r],pointStrokeColor:"#fff",data:o["val"+r]}});var s=new Chart(makeCanvas("quarterly-content-chart-container")).Line(n,{legendTemplate:lineChartLegend});document.getElementById("quarterly-content-legend-container").innerHTML=s.generateLegend(),renderWeekBrowsers(e,r,t)}var n="",o={};a.forEach(function(e,r,t){r>0&&(n+=", "),n=n+"ga:pageTitle=="+e,o["val"+r]=[]});for(var i=[],s=[],c=3,u=0;c>=0;c--,u++)i.push(moment(t).subtract(3*c+3,"months").date(1).format("MMM")+"-"+moment(t).subtract(3*c+1,"months").date(1).format("MMM")),s.push(moment(t).subtract(3*c+3,"months").date(1).format("YYYY-MM-DD")),s.push(moment(t).subtract(3*c,"months").date(1).subtract(1,"days").format("YYYY-MM-DD"));query({ids:e,dimensions:"ga:pageTitle",metrics:"ga:pageviews",filters:n,"start-date":s[0],"end-date":s[1]}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:pageTitle",metrics:"ga:pageviews",filters:n,"start-date":s[2],"end-date":s[3]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:pageTitle",metrics:"ga:pageviews",filters:n,"start-date":s[4],"end-date":s[5]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:pageTitle",metrics:"ga:pageviews",filters:n,"start-date":s[6],"end-date":s[7]})}).then(function(e){o=processResults(e,o,a),h()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderWeekBrowsers(e,r,t){function i(r){var t=0;return r.totalResults>0?(r.rows.forEach(function(e,r){t+=+e[1]}),r.rows.forEach(function(e,r){n.push({value:+e[1],color:fillColors[r],highlight:strokeColors[r],label:e[0]+": "+e[1]+" ("+Math.round(e[1]/t*100)+"%)"}),a.push(e[0])}),!0):(n.push({value:1,color:fillColors[0],highlight:strokeColors[0],label:"No data for selected period"}),allTimeTopBrowsers.length>0?(a=allTimeTopBrowsers.slice(),!0):rateLimitDelay().then(function(r){return query({ids:e,dimensions:"ga:browser",metrics:"ga:pageviews","start-date":moment().subtract(2,"years").format("YYYY-MM-DD"),"end-date":moment().format("YYYY-MM-DD"),sort:"-ga:pageviews","max-results":5})}).then(function(e){return e.totalResults>0&&e.rows.forEach(function(e,r){allTimeTopBrowsers.push(e[0]),a.push(e[0])}),!0})["catch"](function(e){return console.error(e.error.message),!1}))}function s(){var o=new Chart(makeCanvas("weekly-browser-chart-container")).Doughnut(n,{percentageInnerCutout:33,animateScale:!0,legendTemplate:dougnutChartLegend});document.getElementById("weekly-browser-legend-container").innerHTML=o.generateLegend(),renderQuarterlyBrowserUsage(e,r,t,a)}var a=[],n=[];query({ids:e,dimensions:"ga:browser",metrics:"ga:pageviews","start-date":r,"end-date":t,sort:"-ga:pageviews","max-results":5}).then(function(e){return i(e)}).then(function(e){s()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderQuarterlyBrowserUsage(e,r,t,a){function h(){var n={labels:i,datasets:[]};a.forEach(function(e,r,t){n.datasets[r]={label:e,fillColor:fillColors[r],strokeColor:strokeColors[r],pointColor:strokeColors[r],pointStrokeColor:"#fff",data:o["val"+r]}});var s=new Chart(makeCanvas("quarterly-browser-chart-container")).Line(n,{legendTemplate:lineChartLegend});document.getElementById("quarterly-browser-legend-container").innerHTML=s.generateLegend(),renderWeekIEVersion(e,r,t)}var n="",o={};a.forEach(function(e,r,t){r>0&&(n+=", "),n=n+"ga:browser=="+e,o["val"+r]=[]});for(var i=[],s=[],c=3,u=0;c>=0;c--,u++)i.push(moment(t).subtract(3*c+3,"months").date(1).format("MMM")+"-"+moment(t).subtract(3*c+1,"months").date(1).format("MMM")),s.push(moment(t).subtract(3*c+3,"months").date(1).format("YYYY-MM-DD")),s.push(moment(t).subtract(3*c,"months").date(1).subtract(1,"days").format("YYYY-MM-DD"));query({ids:e,dimensions:"ga:browser",metrics:"ga:pageviews",filters:n,"start-date":s[0],"end-date":s[1]}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browser",metrics:"ga:pageviews",filters:n,"start-date":s[2],"end-date":s[3]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browser",metrics:"ga:pageviews",filters:n,"start-date":s[4],"end-date":s[5]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browser",metrics:"ga:pageviews",filters:n,"start-date":s[6],"end-date":s[7]})}).then(function(e){o=processResults(e,o,a),h()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderWeekIEVersion(e,r,t){function i(r){var t=0;return r.totalResults>0?(r.rows.forEach(function(e,r){t+=+e[1]}),r.rows.forEach(function(e,r){n.push({value:+e[1],color:fillColors[r],highlight:strokeColors[r],label:"IE "+e[0]+": "+e[1]+" ("+Math.round(e[1]/t*100)+"%)"}),a.push(e[0])}),!0):(n.push({value:1,color:fillColors[0],highlight:strokeColors[0],label:"No data for selected period"}),allTimeTopIEVersions.length>0?(a=allTimeTopIEVersions.slice(),!0):rateLimitDelay().then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:"ga:browser==Internet Explorer","start-date":moment().subtract(2,"years").format("YYYY-MM-DD"),"end-date":moment().format("YYYY-MM-DD"),sort:"-ga:pageviews","max-results":5})}).then(function(e){return e.totalResults>0&&e.rows.forEach(function(e,r){allTimeTopIEVersions.push(e[0]),a.push(e[0])}),!0})["catch"](function(e){return console.error(e.error.message),!1}))}function s(){var o=new Chart(makeCanvas("weekly-ieversion-chart-container")).Doughnut(n,{percentageInnerCutout:33,animateScale:!0,legendTemplate:dougnutChartLegend});document.getElementById("weekly-ieversion-legend-container").innerHTML=o.generateLegend(),renderQuarterlyIEVersionUsage(e,r,t,a)}var a=[],n=[];query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:"ga:browser==Internet Explorer","start-date":r,"end-date":t,sort:"-ga:pageviews","max-results":5}).then(function(e){return i(e)}).then(function(e){s()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderQuarterlyIEVersionUsage(e,r,t,a){function h(){var n={labels:i,datasets:[]};a.forEach(function(e,r,t){n.datasets[r]={label:"IE "+e,fillColor:fillColors[r],strokeColor:strokeColors[r],pointColor:strokeColors[r],pointStrokeColor:"#fff",data:o["val"+r]}});var s=new Chart(makeCanvas("quarterly-ieversion-chart-container")).Line(n,{legendTemplate:lineChartLegend});document.getElementById("quarterly-ieversion-legend-container").innerHTML=s.generateLegend(),renderWeekFirefoxVersion(e,r,t)}var n="ga:browser==Internet Explorer;",o={};a.forEach(function(e,r,t){r>0&&(n+=", "),n=n+"ga:browserVersion=="+e,o["val"+r]=[]});for(var i=[],s=[],c=3,u=0;c>=0;c--,u++)i.push(moment(t).subtract(3*c+3,"months").date(1).format("MMM")+"-"+moment(t).subtract(3*c+1,"months").date(1).format("MMM")),s.push(moment(t).subtract(3*c+3,"months").date(1).format("YYYY-MM-DD")),s.push(moment(t).subtract(3*c,"months").date(1).subtract(1,"days").format("YYYY-MM-DD"));query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[0],"end-date":s[1]}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[2],"end-date":s[3]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[4],"end-date":s[5]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[6],"end-date":s[7]})}).then(function(e){o=processResults(e,o,a),h()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderWeekFirefoxVersion(e,r,t){function i(r){var t=0;return r.totalResults>0?(r.rows.forEach(function(e,r){t+=+e[1]}),r.rows.forEach(function(e,r){n.push({value:+e[1],color:fillColors[r],highlight:strokeColors[r],label:"Firefox "+e[0]+": "+e[1]+" ("+Math.round(e[1]/t*100)+"%)"}),a.push(e[0])}),!0):(n.push({value:1,color:fillColors[0],highlight:strokeColors[0],label:"No data for selected period"}),allTimeTopFirefoxVersions.length>0?(a=allTimeTopFirefoxVersions.slice(),!0):rateLimitDelay().then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:"ga:browser==Firefox","start-date":moment().subtract(2,"years").format("YYYY-MM-DD"),"end-date":moment().format("YYYY-MM-DD"),sort:"-ga:pageviews","max-results":5})}).then(function(e){return e.totalResults>0&&e.rows.forEach(function(e,r){allTimeTopFirefoxVersions.push(e[0]),a.push(e[0])}),!0})["catch"](function(e){return console.error(e.error.message),!1}))}function s(){var o=new Chart(makeCanvas("weekly-firefoxversion-chart-container")).Doughnut(n,{percentageInnerCutout:33,animateScale:!0,legendTemplate:dougnutChartLegend});document.getElementById("weekly-firefoxversion-legend-container").innerHTML=o.generateLegend(),renderQuarterlyFirefoxVersionUsage(e,r,t,a)}var a=[],n=[];query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:"ga:browser==Firefox","start-date":r,"end-date":t,sort:"-ga:pageviews","max-results":5}).then(function(e){return i(e)}).then(function(e){s()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function renderQuarterlyFirefoxVersionUsage(e,r,t,a){function h(){var e={labels:i,datasets:[]};a.forEach(function(r,t,a){e.datasets[t]={label:"Firefox "+r,fillColor:fillColors[t],strokeColor:strokeColors[t],pointColor:strokeColors[t],pointStrokeColor:"#fff",data:o["val"+t]}});var r=new Chart(makeCanvas("quarterly-firefoxversion-chart-container")).Line(e,{legendTemplate:lineChartLegend});document.getElementById("quarterly-firefoxversion-legend-container").innerHTML=r.generateLegend(),hideLoadingBar()}var n="ga:browser==Firefox;",o={};a.forEach(function(e,r,t){r>0&&(n+=", "),n=n+"ga:browserVersion=="+e,o["val"+r]=[]});for(var i=[],s=[],c=3,u=0;c>=0;c--,u++)i.push(moment(t).subtract(3*c+3,"months").date(1).format("MMM")+"-"+moment(t).subtract(3*c+1,"months").date(1).format("MMM")),s.push(moment(t).subtract(3*c+3,"months").date(1).format("YYYY-MM-DD")),s.push(moment(t).subtract(3*c,"months").date(1).subtract(1,"days").format("YYYY-MM-DD"));query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[0],"end-date":s[1]}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[2],"end-date":s[3]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[4],"end-date":s[5]})}).then(function(e){return o=processResults(e,o,a),rateLimitDelay()}).then(function(r){return query({ids:e,dimensions:"ga:browserVersion",metrics:"ga:pageviews",filters:n,"start-date":s[6],"end-date":s[7]})}).then(function(e){o=processResults(e,o,a),h()})["catch"](function(e){console.error(e.error.message),hideLoadingBar()})}function processResults(e,r,t){if(void 0!==e){var a=[];t.forEach(function(e,r,t){a.push(!1)});var n=r.val0.length;e.totalResults>0&&e.rows.forEach(function(e,o){var i=t.indexOf(e[0]);i>-1&&(a[i]=!0,r["val"+i][n]=+e[1])});var o=0;t.forEach(function(e,t,i){a[t]===!1?r["val"+t].push(0):o+=r["val"+t][n]}),o>0&&t.forEach(function(e,t,a){r["val"+t][n]=(r["val"+t][n]/o*100).toFixed(2)})}return r}function rateLimitDelay(){return new Promise(function(e){setTimeout(e,200)})}function query(e){return new Promise(function(r,t){var a=new gapi.analytics.report.Data({query:e});a.once("success",function(e){r(e)}).once("error",function(e){t(e)}).execute()})}function makeCanvas(e){var r=document.getElementById(e),t=document.createElement("canvas"),a=t.getContext("2d");return r.innerHTML="",t.width=r.offsetWidth,t.height=r.offsetHeight,r.appendChild(t),a}function generateLegend(e,r){var t=document.getElementById(e);t.innerHTML=r.map(function(e){var r=e.color||e.fillColor,t=e.label;return'<li><i style="background:'+r+'"></i>'+t+"</li>"}).join("")}var fillColors=["rgba(115,115,115,0.33)","rgba(241,90,96,0.33)","rgba(122,195,106,0.33)","rgba(90,155,212,0.33)","rgba(250,167,91,0.33)","rgba(158,103,171,0.33)","rgba(193,254,227,0.33)","rgba(215,127,80,0.33)"],strokeColors=["rgba(115,115,115,1)","rgba(241,90,96,1)","rgba(122,195,106,1)","rgba(90,155,212,1)","rgba(250,167,91,1)","rgba(158,103,171,1)","rgba(193,254,227,1)","rgba(215,127,80,1)"],lineChartLegend='<% for (var i=0; i<datasets.length; i++) {%><li><i style="background:<%=datasets[i].fillColor%>; border-width: 1px; border-style: solid; border-color:<%=datasets[i].pointColor%>;"></i><%if (datasets[i].label) {%><%=datasets[i].label%><%}%></li><%}%>',barChartLegend='<% for (var i=0; i<datasets.length; i++) {%><li><i style="background:<%=datasets[i].fillColor%>; border-width: 1px; border-style: solid; border-color:<%=datasets[i].strokeColor%>;"></i><%if (datasets[i].label) {%><%=datasets[i].label%><%}%></li><%}%>',dougnutChartLegend='<% for (var i=0; i<segments.length; i++) {%><li><i style="background:<%=segments[i].fillColor%>; border-width: 1px; border-style: solid; border-color:<%=segments[i].highlightColor%>;"></i><%if (segments[i].label) {%><%=segments[i].label%><%}%></li><%}%>',allTimeTopPageNames=[],allTimeTopBrowsers=[],allTimeTopIEVersions=[],allTimeTopFirefoxVersions=[];